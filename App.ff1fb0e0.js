parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"yrjL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getUniqueId=exports.mergeTransactions=exports.AddressLiteral=exports.Address=void 0;class e{constructor(e){this._address=e}toString(){return this._address}equals(s){return s instanceof e?this._address==s._address:this._address==s}}exports.Address=e;class s extends e{constructor(e){super(e)}}function r(e,s,r){if("old"==r.batchType)return e.push(...s),e;if(0===e.length)return e.push(...s),e;let t=0;for(;t<e.length&&e[t].id.lt.localeCompare(r.maxLt)>=0;)++t;return e.splice(t,0,...s),e}exports.AddressLiteral=s,exports.mergeTransactions=r;const t=4294967295;let o=Math.floor(Math.random()*t);function d(){return o=(o+1)%t}exports.getUniqueId=d;
},{}],"S51G":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseTokensObject=exports.serializeTokensObject=exports.parseAccountInteraction=exports.parsePermissions=exports.parseMessage=exports.serializeMessage=exports.parseTransaction=exports.serializeTransaction=void 0;const e=require("./utils");function s(e){return{...e,inMessage:n(e.inMessage),outMessages:e.outMessages.map(n)}}function t(e){return{...e,inMessage:r(e.inMessage),outMessages:e.outMessages.map(r)}}function n(e){return{...e,src:e.src?e.src.toString():void 0,dst:e.dst?e.dst.toString():void 0}}function r(s){return{...s,src:s.src?new e.Address(s.src):void 0,dst:s.dst?new e.Address(s.dst):void 0}}function o(e){return{...e,accountInteraction:e.accountInteraction?i(e.accountInteraction):void 0}}function i(s){return{...s,address:new e.Address(s.address)}}function c(e){return a(e)}function a(s){if(s instanceof e.Address)return s.toString();if(Array.isArray(s)){const e=[];for(const t of s)e.push(a(t));return e}if(null!=s&&"object"==typeof s){const e={};for(const[t,n]of Object.entries(s))e[t]=a(n);return e}return s}function p(e,s){const t={};for(const n of e)t[n.name]=u(n,s[n.name]);return t}function u(s,t){if(s.type.startsWith("map")){let[e,n]=s.type.split(",");e=e.slice(4),n=n.slice(0,-1);const r=[];for(const[o,i]of t)r.push([u({name:"",type:e},o),u({name:"",type:n,components:s.components},i)]);return r}{const n=s.type.endsWith("[]"),r=!n&&s.type.startsWith("optional"),o=n?s.type.slice(0,-2):r?s.type.slice(9,-1):s.type;if(n){const e={name:s.name,type:o,components:s.components},n=[];for(const s of t)n.push(u(e,s));return n}if(r){if(null==t)return null;return u({name:s.name,type:o,components:s.components},t)}if("tuple"==o){const e={};if(null!=s.components)for(const n of s.components)e[n.name]=u(n,t[n.name]);return e}return"address"==o?new e.Address(t):t}}exports.serializeTransaction=s,exports.parseTransaction=t,exports.serializeMessage=n,exports.parseMessage=r,exports.parsePermissions=o,exports.parseAccountInteraction=i,exports.serializeTokensObject=c,exports.parseTokensObject=p;
},{"./utils":"yrjL"}],"qeQ0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Subscriber=void 0;const t=require("./utils");class s{constructor(t){this.provider=t,this.subscriptions={},this.scanners={}}transactions(t){return this._addSubscription("transactionsFound",t)}oldTransactions(s,r){const o=(0,t.getUniqueId)();return new n(async(t,e)=>{const n=new i(this.provider,{address:s,onData:t,onEnd:e,...r});this.scanners[o]=n,await n.start()},async()=>{const t=this.scanners[o];delete this.scanners[o],null!=t&&await t.stop()},e)}states(t){return this._addSubscription("contractStateChanged",t)}async unsubscribe(){const t=Object.assign({},this.subscriptions);for(const e of Object.keys(this.subscriptions))delete this.subscriptions[e];const s=Object.assign({},this.scanners);for(const e of Object.keys(this.scanners))delete this.scanners[e];await Promise.all(Object.values(t).map(async t=>{const s=Object.assign({},t);for(const e of Object.keys(s))delete t[e];await Promise.all(Object.values(s).map(t=>{if(null!=t)return t.subscription.then(t=>t.unsubscribe()).catch(()=>{})}))}).concat(Object.values(s).map(t=>t.stop())))}_addSubscription(s,i){const o=(0,t.getUniqueId)();return new n((t,e)=>{let n=this.subscriptions[i.toString()],a=null==n?void 0:n[s];if(null==a){const c={[o]:{onData:t,onEnd:e,queue:new r}};a={subscription:this.provider.subscribe(s,{address:i}).then(t=>(t.on("data",t=>{Object.values(c).forEach(({onData:s,queue:e})=>{e.enqueue(()=>s(t))})}),t.on("unsubscribed",()=>{Object.values(c).forEach(({onEnd:t,queue:s})=>{delete c[o],s.clear(),s.enqueue(async()=>t())})}),t)).catch(t=>{throw console.error(t),Object.values(c).forEach(({onEnd:t,queue:s})=>{delete c[o],s.clear(),s.enqueue(()=>t())}),t}),handlers:c},null==n?(n={[s]:a},this.subscriptions[i.toString()]=n):n[s]=a}else a.handlers[o]={onData:t,onEnd:e,queue:new r}},()=>{const t=this.subscriptions[i.toString()];if(null==t)return;const e=t[s];if(null!=e&&(delete e.handlers[o],0===Object.keys(e.handlers).length)){const n=e.subscription;delete t[s],n.then(t=>t.unsubscribe()).catch(console.debug)}0===Object.keys(t).length&&delete this.subscriptions[i.toString()]},e)}}async function e(t,s){await s(t)}exports.Subscriber=s;class n{constructor(t,s,e){this.makeProducer=t,this.stopProducer=s,this.extractor=e}first(){return new Promise(async(t,s)=>{this.makeProducer(async s=>{await this.extractor(s,s=>{this.stopProducer(),t(s)})},()=>s(new Error("Subscription closed")))})}on(t){this.makeProducer(async s=>{await this.extractor(s,t)},()=>{})}merge(t){return new n(async(s,e)=>{const n={counter:0},i=()=>{2==++n.counter&&e()};this.makeProducer(s,i),t.makeProducer(s,i)},()=>{this.stopProducer(),t.stopProducer()},this.extractor)}filter(t){return new n(this.makeProducer,this.stopProducer,(s,e)=>this.extractor(s,async s=>{await t(s)&&await e(s)}))}filterMap(t){return new n(this.makeProducer,this.stopProducer,(s,e)=>this.extractor(s,async s=>{const n=await t(s);void 0!==n&&await e(n)}))}map(t){return this.filterMap(t)}flatMap(t){return new n(this.makeProducer,this.stopProducer,(s,e)=>this.extractor(s,async s=>{const n=await t(s);for(const t of n)await e(t)}))}skip(t){const s={index:0};return new n(this.makeProducer,this.stopProducer,(e,n)=>this.extractor(e,async e=>{s.index>=t?await n(e):++s.index}))}skipWhile(t){const s={shouldSkip:!0};return new n(this.makeProducer,this.stopProducer,(e,n)=>this.extractor(e,async e=>{s.shouldSkip&&await t(e)||(s.shouldSkip=!1,await n(e))}))}}class i{constructor(t,{address:s,onData:e,onEnd:n,fromLt:i,fromUtime:o}){this.provider=t,this.queue=new r,this.isRunning=!1,this.address=s,this.onData=e,this.onEnd=n,this.fromLt=i,this.fromUtime=o}async start(){this.isRunning||null!=this.promise||(this.isRunning=!0,this.promise=(async()=>{for(;this.isRunning;)try{const{transactions:s,continuation:e}=await this.provider.getTransactions({address:this.address,continuation:this.continuation});if(!this.isRunning||null==s.length)break;const n=s.filter(t=>(null==this.fromLt||t.id.lt>this.fromLt)&&(null==this.fromUtime||t.createdAt>this.fromUtime));if(0==n.length)break;const i={maxLt:n[0].id.lt,minLt:n[n.length-1].id.lt,batchType:"old"};if(this.queue.enqueue(()=>this.onData({address:this.address,transactions:n,info:i})),null==e)break;this.continuation=e}catch(t){console.error(t)}this.queue.enqueue(async()=>this.onEnd()),this.isRunning=!1,this.continuation=void 0})())}async stop(){this.isRunning=!1,this.queue.clear(),null!=this.promise?await this.promise:this.onEnd()}}class r{constructor(){this.queue=[],this.workingOnPromise=!1}enqueue(t){this.queue.push(t),this._dequeue().catch(()=>{})}clear(){this.queue.length=0}async _dequeue(){if(this.workingOnPromise)return;const t=this.queue.shift();t&&(this.workingOnPromise=!0,t().then(()=>{this.workingOnPromise=!1,this._dequeue()}).catch(()=>{this.workingOnPromise=!1,this._dequeue()}))}}
},{"./utils":"yrjL"}],"Xnvh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TvmException=exports.Contract=void 0;const t=require("./models");class s{constructor(s,i,n){if(!Array.isArray(i.functions))throw new Error("Invalid abi. Functions array required");if(!Array.isArray(i.events))throw new Error("Invalid abi. Events array required");this._provider=s,this._abi=JSON.stringify(i),this._functions=i.functions.reduce((t,s)=>(t[s.name]={inputs:s.inputs||[],outputs:s.outputs||[]},t),{}),this._events=i.events.reduce((t,s)=>(t[s.name]={inputs:s.inputs||[]},t),{}),this._address=n;class a{constructor(s,e,i,n,a,r){this.provider=s,this.functionAbi=e,this.abi=i,this.address=n,this.method=a,this.params=(0,t.serializeTokensObject)(r)}async send(s){const{transaction:e}=await this.provider.rawApi.sendMessage({sender:s.from.toString(),recipient:this.address.toString(),amount:s.amount,bounce:null==s.bounce||s.bounce,payload:{abi:this.abi,method:this.method,params:this.params}});return(0,t.parseTransaction)(e)}async sendWithResult(s){const e=this.provider.createSubscriber();try{let n,a;const r=new Promise(t=>{a=(s=>t(s))}),o=[];e.transactions(this.address).flatMap(t=>t.transactions).filter(t=>{var e;return(null===(e=t.inMessage.src)||void 0===e?void 0:e.equals(s.from))||!1}).on(t=>{null==n?o.push(t):n.possibleMessages.findIndex(s=>s.hash==t.inMessage.hash)>=0&&(null==a||a(t))});const u=await this.send(s),c=u.outMessages.filter(t=>{var s;return(null===(s=t.dst)||void 0===s?void 0:s.equals(this.address))||!1});n={transaction:u,possibleMessages:c};const d=o.find(t=>c.findIndex(s=>s.hash==t.inMessage.hash)>=0);null!=d&&(null==a||a(d));const h=await r;let p=void 0;try{const s=await this.provider.rawApi.decodeTransaction({transaction:(0,t.serializeTransaction)(h),abi:this.abi,method:this.method});null!=s&&(p=null!=this.functionAbi.outputs?(0,t.parseTokensObject)(this.functionAbi.outputs,s.output):{})}catch(i){console.error(i)}return{parentTransaction:n.transaction,childTransaction:h,output:p}}finally{await e.unsubscribe()}}async estimateFees(t){const{fees:s}=await this.provider.rawApi.estimateFees({sender:t.from.toString(),recipient:this.address.toString(),amount:t.amount,payload:{abi:this.abi,method:this.method,params:this.params}});return s}async sendExternal(s){let e=!0===s.withoutSignature?this.provider.rawApi.sendUnsignedExternalMessage:this.provider.rawApi.sendExternalMessage,{transaction:i,output:n}=await e({publicKey:s.publicKey,recipient:this.address.toString(),stateInit:s.stateInit,payload:{abi:this.abi,method:this.method,params:this.params},local:s.local});return{transaction:(0,t.parseTransaction)(i),output:null!=n?(0,t.parseTokensObject)(this.functionAbi.outputs,n):void 0}}async call(s={}){let{output:i,code:n}=await this.provider.rawApi.runLocal({address:this.address.toString(),cachedState:s.cachedState,responsible:s.responsible,functionCall:{abi:this.abi,method:this.method,params:this.params}});if(null==i||0!=n)throw new e(n);return(0,t.parseTokensObject)(this.functionAbi.outputs,i)}}this._methods=new Proxy({},{get:(t,s)=>{const e=this._functions[s];return t=>new a(this._provider,e,this._abi,this._address,s,t)}})}get methods(){return this._methods}get address(){return this._address}get abi(){return this._abi}async decodeTransaction(s){try{const i=await this._provider.rawApi.decodeTransaction({transaction:(0,t.serializeTransaction)(s.transaction),abi:this._abi,method:s.methods});if(null==i)return;let{method:n,input:a,output:r}=i;const o=this._functions[n];return{method:n,input:null!=o.inputs?(0,t.parseTokensObject)(o.inputs,a):{},output:null!=o.outputs?(0,t.parseTokensObject)(o.outputs,r):{}}}catch(e){return}}async decodeTransactionEvents(s){try{const{events:i}=await this._provider.rawApi.decodeTransactionEvents({transaction:(0,t.serializeTransaction)(s.transaction),abi:this._abi}),n=[];for(const{event:s,data:e}of i){const i=this._events[s];n.push({event:s,data:null!=i.inputs?(0,t.parseTokensObject)(i.inputs,e):{}})}return n}catch(e){return[]}}async decodeInputMessage(s){try{const i=await this._provider.rawApi.decodeInput({abi:this._abi,body:s.body,internal:s.internal,method:s.methods});if(null==i)return;let{method:n,input:a}=i;const r=this._functions[n];return{method:n,input:null!=r.inputs?(0,t.parseTokensObject)(r.inputs,a):{}}}catch(e){return}}async decodeOutputMessage(s){try{const i=await this._provider.rawApi.decodeOutput({abi:this._abi,body:s.body,method:s.methods});if(null==i)return;let{method:n,output:a}=i;const r=this._functions[n];return{method:n,output:null!=r.outputs?(0,t.parseTokensObject)(r.outputs,a):{}}}catch(e){return}}}exports.Contract=s;class e extends Error{constructor(t){super(`TvmException: ${t}`),this.code=t}}exports.TvmException=e;
},{"./models":"S51G"}],"mEq5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});
},{}],"RebX":[function(require,module,exports) {
"use strict";var t=this&&this.__createBinding||(Object.create?function(t,e,s,r){void 0===r&&(r=s),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[s]}})}:function(t,e,s,r){void 0===r&&(r=s),t[r]=e[s]}),e=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(null!=s)for(var i in s)"default"!==i&&Object.prototype.hasOwnProperty.call(s,i)&&t(r,s,i);return e(r,s),r},r=this&&this.__exportStar||function(e,s){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(s,r)||t(s,e,r)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProviderNotInitializedException=exports.ProviderNotFoundException=exports.ProviderRpcClient=exports.hasEverscaleProvider=exports.mergeTransactions=exports.AddressLiteral=exports.Address=exports.Subscriber=void 0;const i=require("./models"),n=require("./utils"),a=s(require("./stream")),o=s(require("./contract"));r(require("./api"),exports),r(require("./models"),exports),r(require("./contract"),exports);var c=require("./stream");Object.defineProperty(exports,"Subscriber",{enumerable:!0,get:function(){return c.Subscriber}});var d=require("./utils");let u;async function p(){return await u,!0===window.__hasEverscaleProvider||!0===window.hasTonProvider}Object.defineProperty(exports,"Address",{enumerable:!0,get:function(){return d.Address}}),Object.defineProperty(exports,"AddressLiteral",{enumerable:!0,get:function(){return d.AddressLiteral}}),Object.defineProperty(exports,"mergeTransactions",{enumerable:!0,get:function(){return d.mergeTransactions}}),u="complete"==document.readyState?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>{t()})}),exports.hasEverscaleProvider=p;class l{constructor(t={}){this._subscriptions={},this._contractSubscriptions={};const e=this;this.Contract=class extends o.Contract{constructor(t,s){super(e,t,s)}};this.Subscriber=class extends a.Subscriber{constructor(){super(e)}},this._properties=t,this._api=new Proxy({},{get:(t,e)=>t=>{if(null!=this._provider)return this._provider.request({method:e,params:t});throw new b}}),this._provider=window.__ever||window.ton,null!=this._provider?this._mainInitializationPromise=Promise.resolve():this._mainInitializationPromise=p().then(t=>new Promise((e,s)=>{if(t)if(this._provider=window.__ever||window.ton,null!=this._provider)e();else{const t=!0===window.__hasEverscaleProvider?"ever#initialized":"ton#initialized";window.addEventListener(t,t=>{this._provider=window.__ever||window.ton,e()})}else s(new h)})),this._mainInitializationPromise.then(()=>{null!=this._provider&&this._registerEventHandlers(this._provider)})}async hasProvider(){return p()}async ensureInitialized(){try{await this._mainInitializationPromise}catch(t){if(null==this._properties.fallback)throw t;null==this._additionalInitializationPromise&&(this._additionalInitializationPromise=this._properties.fallback().then(async t=>{this._provider=t,this._registerEventHandlers(this._provider)})),await this._additionalInitializationPromise}}get isInitialized(){return null!=this._provider}get raw(){if(null!=this._provider)return this._provider;throw new b}get rawApi(){return this._api}createContract(t,e){return new this.Contract(t,e)}createSubscriber(){return new this.Subscriber}async requestPermissions(t){const e=await this._api.requestPermissions({permissions:t.permissions});return(0,i.parsePermissions)(e)}async changeAccount(){await this._api.changeAccount()}async disconnect(){await this._api.disconnect()}async subscribe(t,e){class s{constructor(t,e){this._subscribe=t,this._unsubscribe=e,this._listeners={data:[],subscribed:[],unsubscribed:[]}}on(t,e){return this._listeners[t].push(e),this}async subscribe(){await this._subscribe(this);for(const t of this._listeners.subscribed)t()}async unsubscribe(){await this._unsubscribe();for(const t of this._listeners.unsubscribed)t()}notify(t){for(const e of this._listeners.data)e(t)}}let r=this._getEventSubscriptions(t);const i=(0,n.getUniqueId)();switch(t){case"connected":case"disconnected":case"networkChanged":case"permissionsChanged":case"loggedOut":{const t=new s(async t=>{null==r[i]&&(r[i]=(e=>{t.notify(e)}))},async()=>{delete r[i]});return await t.subscribe(),t}case"transactionsFound":case"contractStateChanged":{const n=e.address.toString(),a=new s(async e=>{if(null!=r[i])return;r[i]=(t=>{t.address.toString()==n&&e.notify(t)});let s=this._contractSubscriptions[n];null==s&&(s={},this._contractSubscriptions[n]=s),s[i]={state:"contractStateChanged"==t,transactions:"transactionsFound"==t};const{total:a,withoutExcluded:o}=w(Object.values(s),s[i]);try{a.transactions==o.transactions&&a.state==o.state||await this.rawApi.subscribe({address:n,subscriptions:a})}catch(c){throw delete r[i],delete s[i],c}},async()=>{delete r[i];const t=this._contractSubscriptions[n];if(null==t)return;const e=t[i],{total:s,withoutExcluded:a}=w(Object.values(t),e);delete t[i],a.transactions||a.state?s.transactions==a.transactions&&s.state==a.state||await this.rawApi.subscribe({address:n,subscriptions:a}):await this.rawApi.unsubscribe({address:n})});return await a.subscribe(),a}default:throw new Error(`Unknown event ${t}`)}}async getProviderState(){const t=await this._api.getProviderState();return{...t,permissions:(0,i.parsePermissions)(t.permissions)}}async getFullContractState(t){return await this._api.getFullContractState({address:t.address.toString()})}async getAccountsByCodeHash(t){const{accounts:e,continuation:s}=await this._api.getAccountsByCodeHash({...t});return{accounts:e.map(t=>new n.Address(t)),continuation:s}}async getTransactions(t){const{transactions:e,continuation:s,info:r}=await this._api.getTransactions({...t,address:t.address.toString()});return{transactions:e.map(i.parseTransaction),continuation:s,info:r}}async getTransaction(t){const{transaction:e}=await this._api.getTransaction({...t});return{transaction:e?(0,i.parseTransaction)(e):void 0}}async getExpectedAddress(t,e){const{address:s}=await this._api.getExpectedAddress({abi:JSON.stringify(t),...e,initParams:(0,i.serializeTokensObject)(e.initParams)});return new n.Address(s)}async getBocHash(t){return await this._api.getBocHash({boc:t}).then(({hash:t})=>t)}async packIntoCell(t){return await this._api.packIntoCell({structure:t.structure,data:(0,i.serializeTokensObject)(t.data)})}async unpackFromCell(t){const{data:e}=await this._api.unpackFromCell({...t,structure:t.structure});return{data:(0,i.parseTokensObject)(t.structure,e)}}async extractPublicKey(t){const{publicKey:e}=await this._api.extractPublicKey({boc:t});return e}async codeToTvc(t){const{tvc:e}=await this._api.codeToTvc({code:t});return e}async splitTvc(t){return await this._api.splitTvc({tvc:t})}async addAsset(t){let e;switch(t.type){case"tip3_token":e={rootContract:t.params.rootContract.toString()};break;default:throw new Error("Unknown asset type")}return await this._api.addAsset({account:t.account.toString(),type:t.type,params:e})}async verifySignature(t){return await this._api.verifySignature(t)}async signData(t){return await this._api.signData(t)}async signDataRaw(t){return await this._api.signDataRaw(t)}async encryptData(t){const{encryptedData:e}=await this._api.encryptData(t);return e}async decryptData(t){const{data:e}=await this._api.decryptData({encryptedData:t});return e}async sendMessage(t){const{transaction:e}=await this._api.sendMessage({...t,sender:t.sender.toString(),recipient:t.recipient.toString(),payload:t.payload?{abi:t.payload.abi,method:t.payload.method,params:(0,i.serializeTokensObject)(t.payload.params)}:void 0});return{transaction:(0,i.parseTransaction)(e)}}_registerEventHandlers(t){const e={connected:t=>t,disconnected:t=>t,transactionsFound:t=>({address:new n.Address(t.address),transactions:t.transactions.map(i.parseTransaction),info:t.info}),contractStateChanged:t=>({address:new n.Address(t.address),state:t.state}),networkChanged:t=>t,permissionsChanged:t=>({permissions:(0,i.parsePermissions)(t.permissions)}),loggedOut:t=>t};for(const[s,r]of Object.entries(e))t.addListener(s,t=>{const e=this._subscriptions[s];if(null==e)return;const i=r(t);for(const s of Object.values(e))s(i)})}_getEventSubscriptions(t){let e=this._subscriptions[t];return null==e&&(e={},this._subscriptions[t]=e),e}}exports.ProviderRpcClient=l;class h extends Error{constructor(){super("Everscale provider was not found")}}exports.ProviderNotFoundException=h;class b extends Error{constructor(){super("Everscale provider was not initialized yet")}}function w(t,e){const s={state:!1,transactions:!1},r=Object.assign({},s);for(const i of t){if(r.transactions&&r.state)break;s.state||(s.state=i.state),s.transactions||(s.transactions=i.transactions),i!=e&&(r.state||(r.state=i.state),r.transactions||(r.transactions=i.transactions))}return{total:s,withoutExcluded:r}}exports.ProviderNotInitializedException=b;
},{"./models":"S51G","./utils":"yrjL","./stream":"qeQ0","./contract":"Xnvh","./api":"mEq5"}],"YH9q":[function(require,module,exports) {
"use strict";let n;Object.defineProperty(exports,"__esModule",{value:!0}),exports.GqlTransport=exports.GqlQuery=exports.GenericContract=exports.ClockWithOffset=void 0,exports.checkAddress=x,exports.codeToTvc=S,exports.createExternalMessageWithoutSignature=$,exports.decodeEvent=B,exports.decodeInput=I,exports.decodeOutput=R,exports.decodeTransaction=W,exports.decodeTransactionEvents=L,exports.default=void 0,exports.encodeInternalInput=F,exports.extractPublicKey=E,exports.getBocHash=O,exports.getExpectedAddress=q,exports.packIntoCell=C,exports.runLocal=A,exports.splitTvc=j,exports.unpackFromCell=M,exports.verifySignature=G;let t=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});t.decode();let _=null;function e(){return null!==_&&_.buffer===n.memory.buffer||(_=new Uint8Array(n.memory.buffer)),_}function r(n,_){return t.decode(e().subarray(n,n+_))}const o=new Array(32).fill(void 0);o.push(void 0,null,!0,!1);let i=o.length;function a(n){i===o.length&&o.push(o.length+1);const t=i;return i=o[t],o[t]=n,t}function c(n){return o[n]}function s(n){n<36||(o[n]=i,i=n)}function l(n){const t=c(n);return s(n),t}let d=0,g=new TextEncoder("utf-8");const w="function"==typeof g.encodeInto?function(n,t){return g.encodeInto(n,t)}:function(n,t){const _=g.encode(n);return t.set(_),{read:n.length,written:_.length}};function b(n,t,_){if(void 0===_){const _=g.encode(n),r=t(_.length);return e().subarray(r,r+_.length).set(_),d=_.length,r}let r=n.length,o=t(r);const i=e();let a=0;for(;a<r;a++){const t=n.charCodeAt(a);if(t>127)break;i[o+a]=t}if(a!==r){0!==a&&(n=n.slice(a)),o=_(o,r,r=a+3*n.length);const t=e().subarray(o+a,o+r);a+=w(n,t).written}return d=a,o}function u(n){return null==n}let f=null;function p(){return null!==f&&f.buffer===n.memory.buffer||(f=new Int32Array(n.memory.buffer)),f}let y=null;function h(){return null!==y&&y.buffer===n.memory.buffer||(y=new Float64Array(n.memory.buffer)),y}function m(n){const t=typeof n;if("number"==t||"boolean"==t||null==n)return`${n}`;if("string"==t)return`"${n}"`;if("symbol"==t){const t=n.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=n.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(n)){const t=n.length;let _="[";t>0&&(_+=m(n[0]));for(let e=1;e<t;e++)_+=", "+m(n[e]);return _+="]"}const _=/\[object ([^\]]+)\]/.exec(toString.call(n));let e;if(!(_.length>1))return toString.call(n);if("Object"==(e=_[1]))try{return"Object("+JSON.stringify(n)+")"}catch(r){return"Object"}return n instanceof Error?`${n.name}: ${n.message}\n${n.stack}`:e}function v(t,_,e,r){const o={a:t,b:_,cnt:1,dtor:e},i=(...t)=>{o.cnt++;const _=o.a;o.a=0;try{return r(_,o.b,...t)}finally{0==--o.cnt?n.__wbindgen_export_2.get(o.dtor)(_,o.b):o.a=_}};return i.original=o,i}function k(t,_,e){n._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__hbb120239a7c4e272(t,_,a(e))}function x(t){var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;return 0!==n.checkAddress(_,e)}function T(n,t){if(!(n instanceof t))throw new Error(`expected instance of ${t.name}`);return n.ptr}function A(t,_,e,r,o,i){try{const m=n.__wbindgen_add_to_stack_pointer(-16);T(t,U);var c=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),s=d,g=b(e,n.__wbindgen_malloc,n.__wbindgen_realloc),w=d,u=b(r,n.__wbindgen_malloc,n.__wbindgen_realloc),f=d;n.runLocal(m,t.ptr,c,s,g,w,u,f,a(o),i);var y=p()[m/4+0],h=p()[m/4+1];if(p()[m/4+2])throw l(h);return l(y)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function q(t,_,e,o,i){try{const A=n.__wbindgen_add_to_stack_pointer(-16);var c=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),s=d,g=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),w=d,f=u(o)?0:b(o,n.__wbindgen_malloc,n.__wbindgen_realloc),y=d;n.getExpectedAddress(A,c,s,g,w,e,f,y,a(i));var h=p()[A/4+0],m=p()[A/4+1],v=p()[A/4+2],k=p()[A/4+3],x=h,T=m;if(k)throw x=0,T=0,l(v);return r(x,T)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(x,T)}}function O(t){try{const w=n.__wbindgen_add_to_stack_pointer(-16);var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;n.getBocHash(w,_,e);var o=p()[w/4+0],i=p()[w/4+1],a=p()[w/4+2],c=p()[w/4+3],s=o,g=i;if(c)throw s=0,g=0,l(a);return r(s,g)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(s,g)}}function C(t,_){try{const g=n.__wbindgen_add_to_stack_pointer(-16);n.packIntoCell(g,a(t),a(_));var e=p()[g/4+0],o=p()[g/4+1],i=p()[g/4+2],c=p()[g/4+3],s=e,d=o;if(c)throw s=0,d=0,l(i);return r(s,d)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(s,d)}}function M(t,_,e){try{const s=n.__wbindgen_add_to_stack_pointer(-16);var r=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),o=d;n.unpackFromCell(s,a(t),r,o,e);var i=p()[s/4+0],c=p()[s/4+1];if(p()[s/4+2])throw l(c);return l(i)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function E(t){try{const w=n.__wbindgen_add_to_stack_pointer(-16);var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;n.extractPublicKey(w,_,e);var o=p()[w/4+0],i=p()[w/4+1],a=p()[w/4+2],c=p()[w/4+3],s=o,g=i;if(c)throw s=0,g=0,l(a);return r(s,g)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(s,g)}}function S(t){try{const w=n.__wbindgen_add_to_stack_pointer(-16);var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;n.codeToTvc(w,_,e);var o=p()[w/4+0],i=p()[w/4+1],a=p()[w/4+2],c=p()[w/4+3],s=o,g=i;if(c)throw s=0,g=0,l(a);return r(s,g)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(s,g)}}function j(t){try{const i=n.__wbindgen_add_to_stack_pointer(-16);var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;n.splitTvc(i,_,e);var r=p()[i/4+0],o=p()[i/4+1];if(p()[i/4+2])throw l(o);return l(r)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function F(t,_,e){try{const m=n.__wbindgen_add_to_stack_pointer(-16);var o=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),i=d,c=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),s=d;n.encodeInternalInput(m,o,i,c,s,a(e));var g=p()[m/4+0],w=p()[m/4+1],u=p()[m/4+2],f=p()[m/4+3],y=g,h=w;if(f)throw y=0,h=0,l(u);return r(y,h)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(y,h)}}function I(t,_,e,r){try{const u=n.__wbindgen_add_to_stack_pointer(-16);var o=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),i=d,c=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),s=d;n.decodeInput(u,o,i,c,s,a(e),r);var g=p()[u/4+0],w=p()[u/4+1];if(p()[u/4+2])throw l(w);return l(g)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function B(t,_,e){try{const w=n.__wbindgen_add_to_stack_pointer(-16);var r=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),o=d,i=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),c=d;n.decodeEvent(w,r,o,i,c,a(e));var s=p()[w/4+0],g=p()[w/4+1];if(p()[w/4+2])throw l(g);return l(s)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function R(t,_,e){try{const w=n.__wbindgen_add_to_stack_pointer(-16);var r=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),o=d,i=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),c=d;n.decodeOutput(w,r,o,i,c,a(e));var s=p()[w/4+0],g=p()[w/4+1];if(p()[w/4+2])throw l(g);return l(s)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function W(t,_,e){try{const s=n.__wbindgen_add_to_stack_pointer(-16);var r=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),o=d;n.decodeTransaction(s,a(t),r,o,a(e));var i=p()[s/4+0],c=p()[s/4+1];if(p()[s/4+2])throw l(c);return l(i)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function L(t,_){try{const c=n.__wbindgen_add_to_stack_pointer(-16);var e=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),r=d;n.decodeTransactionEvents(c,a(t),e,r);var o=p()[c/4+0],i=p()[c/4+1];if(p()[c/4+2])throw l(i);return l(o)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function G(t,_,e){try{const u=n.__wbindgen_add_to_stack_pointer(-16);var r=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),o=d,i=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),a=d,c=b(e,n.__wbindgen_malloc,n.__wbindgen_realloc),s=d;n.verifySignature(u,r,o,i,a,c,s);var g=p()[u/4+0],w=p()[u/4+1];if(p()[u/4+2])throw l(w);return 0!==g}finally{n.__wbindgen_add_to_stack_pointer(16)}}function $(t,_,e,r,o,i){try{const x=n.__wbindgen_add_to_stack_pointer(-16);var c=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),s=d,g=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),w=d,f=b(e,n.__wbindgen_malloc,n.__wbindgen_realloc),y=d,h=u(r)?0:b(r,n.__wbindgen_malloc,n.__wbindgen_realloc),m=d;n.createExternalMessageWithoutSignature(x,c,s,g,w,f,y,h,m,a(o),i);var v=p()[x/4+0],k=p()[x/4+1];if(p()[x/4+2])throw l(k);return l(v)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function P(t,_){try{return t.apply(this,_)}catch(e){n.__wbindgen_exn_store(a(e))}}function H(t,_,e,r){n.wasm_bindgen__convert__closures__invoke2_mut__h7bcd9da4440792bc(t,_,a(e),a(r))}class U{static __wrap(n){const t=Object.create(U.prototype);return t.ptr=n,t}__destroy_into_raw(){const n=this.ptr;return this.ptr=0,n}free(){const t=this.__destroy_into_raw();n.__wbg_clockwithoffset_free(t)}constructor(){var t=n.clockwithoffset_new();return U.__wrap(t)}updateOffset(t){n.clockwithoffset_updateOffset(this.ptr,t)}offsetMs(){return n.clockwithoffset_offsetMs(this.ptr)}}exports.ClockWithOffset=U;class N{static __wrap(n){const t=Object.create(N.prototype);return t.ptr=n,t}__destroy_into_raw(){const n=this.ptr;return this.ptr=0,n}free(){const t=this.__destroy_into_raw();n.__wbg_genericcontract_free(t)}get address(){try{const e=n.__wbindgen_add_to_stack_pointer(-16);n.genericcontract_address(e,this.ptr);var t=p()[e/4+0],_=p()[e/4+1];return r(t,_)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(t,_)}}sendMessageLocally(t){try{const r=n.__wbindgen_add_to_stack_pointer(-16);n.genericcontract_sendMessageLocally(r,this.ptr,a(t));var _=p()[r/4+0],e=p()[r/4+1];if(p()[r/4+2])throw l(e);return l(_)}finally{n.__wbindgen_add_to_stack_pointer(16)}}sendMessage(t){try{const r=n.__wbindgen_add_to_stack_pointer(-16);n.genericcontract_sendMessage(r,this.ptr,a(t));var _=p()[r/4+0],e=p()[r/4+1];if(p()[r/4+2])throw l(e);return l(_)}finally{n.__wbindgen_add_to_stack_pointer(16)}}refresh(){return l(n.genericcontract_refresh(this.ptr))}handleBlock(t){var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;return l(n.genericcontract_handleBlock(this.ptr,_,e))}preloadTransactions(t,_){try{const s=n.__wbindgen_add_to_stack_pointer(-16);var e=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),r=d,o=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),i=d;n.genericcontract_preloadTransactions(s,this.ptr,e,r,o,i);var a=p()[s/4+0],c=p()[s/4+1];if(p()[s/4+2])throw l(c);return l(a)}finally{n.__wbindgen_add_to_stack_pointer(16)}}get pollingMethod(){return l(n.genericcontract_pollingMethod(this.ptr))}}exports.GenericContract=N;class D{static __wrap(n){const t=Object.create(D.prototype);return t.ptr=n,t}__destroy_into_raw(){const n=this.ptr;return this.ptr=0,n}free(){const t=this.__destroy_into_raw();n.__wbg_gqlquery_free(t)}onReceive(t){const _=this.__destroy_into_raw();var e=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),r=d;n.gqlquery_onReceive(_,e,r)}onError(t){const _=this.__destroy_into_raw();n.gqlquery_onError(_,a(t))}onTimeout(){const t=this.__destroy_into_raw();n.gqlquery_onTimeout(t)}}exports.GqlQuery=D;class K{static __wrap(n){const t=Object.create(K.prototype);return t.ptr=n,t}__destroy_into_raw(){const n=this.ptr;return this.ptr=0,n}free(){const t=this.__destroy_into_raw();n.__wbg_gqltransport_free(t)}constructor(t,_){T(t,U);var e=n.gqltransport_new(t.ptr,a(_));return K.__wrap(e)}subscribeToGenericContract(t,_){try{const c=n.__wbindgen_add_to_stack_pointer(-16);var e=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),r=d;n.gqltransport_subscribeToGenericContract(c,this.ptr,e,r,a(_));var o=p()[c/4+0],i=p()[c/4+1];if(p()[c/4+2])throw l(i);return l(o)}finally{n.__wbindgen_add_to_stack_pointer(16)}}getLatestBlock(t){try{const i=n.__wbindgen_add_to_stack_pointer(-16);var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;n.gqltransport_getLatestBlock(i,this.ptr,_,e);var r=p()[i/4+0],o=p()[i/4+1];if(p()[i/4+2])throw l(o);return l(r)}finally{n.__wbindgen_add_to_stack_pointer(16)}}waitForNextBlock(t,_,e){try{const g=n.__wbindgen_add_to_stack_pointer(-16);var r=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),o=d,i=b(_,n.__wbindgen_malloc,n.__wbindgen_realloc),a=d;n.gqltransport_waitForNextBlock(g,this.ptr,r,o,i,a,e);var c=p()[g/4+0],s=p()[g/4+1];if(p()[g/4+2])throw l(s);return l(c)}finally{n.__wbindgen_add_to_stack_pointer(16)}}getFullContractState(t){try{const i=n.__wbindgen_add_to_stack_pointer(-16);var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;n.gqltransport_getFullContractState(i,this.ptr,_,e);var r=p()[i/4+0],o=p()[i/4+1];if(p()[i/4+2])throw l(o);return l(r)}finally{n.__wbindgen_add_to_stack_pointer(16)}}getAccountsByCodeHash(t,_,e){try{const g=n.__wbindgen_add_to_stack_pointer(-16);var r=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),o=d,i=u(e)?0:b(e,n.__wbindgen_malloc,n.__wbindgen_realloc),a=d;n.gqltransport_getAccountsByCodeHash(g,this.ptr,r,o,_,i,a);var c=p()[g/4+0],s=p()[g/4+1];if(p()[g/4+2])throw l(s);return l(c)}finally{n.__wbindgen_add_to_stack_pointer(16)}}getTransactions(t,_,e){try{const s=n.__wbindgen_add_to_stack_pointer(-16);var r=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),o=d;n.gqltransport_getTransactions(s,this.ptr,r,o,u(_)?0:a(_),e);var i=p()[s/4+0],c=p()[s/4+1];if(p()[s/4+2])throw l(c);return l(i)}finally{n.__wbindgen_add_to_stack_pointer(16)}}getTransaction(t){try{const i=n.__wbindgen_add_to_stack_pointer(-16);var _=b(t,n.__wbindgen_malloc,n.__wbindgen_realloc),e=d;n.gqltransport_getTransaction(i,this.ptr,_,e);var r=p()[i/4+0],o=p()[i/4+1];if(p()[i/4+2])throw l(o);return l(r)}finally{n.__wbindgen_add_to_stack_pointer(16)}}}async function Q(n,t){if("function"==typeof Response&&n instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(n,t)}catch(_){if("application/wasm"==n.headers.get("Content-Type"))throw _;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",_)}const e=await n.arrayBuffer();return await WebAssembly.instantiate(e,t)}{const _=await WebAssembly.instantiate(n,t);return _ instanceof WebAssembly.Instance?{instance:_,module:n}:_}}async function J(t){void 0===t&&(t=new URL("nekoton_wasm_bg.wasm",import.meta.url));const _={wbg:{}};_.wbg.__wbg_onMessageSent_c7b95611372f4fdb=function(n,t,_){c(n).onMessageSent(l(t),l(_))},_.wbg.__wbg_onMessageExpired_c8f1d6a41c9d2025=function(n,t){c(n).onMessageExpired(l(t))},_.wbg.__wbg_onStateChanged_16e7cef155510cc3=function(n,t){c(n).onStateChanged(l(t))},_.wbg.__wbg_onTransactionsFound_d410dfda73b53529=function(n,t,_){c(n).onTransactionsFound(l(t),l(_))},_.wbg.__wbindgen_string_new=function(n,t){return a(r(n,t))},_.wbg.__wbindgen_object_drop_ref=function(n){l(n)},_.wbg.__wbindgen_number_new=function(n){return a(n)},_.wbg.__wbindgen_string_get=function(t,_){const e=c(_);var r="string"==typeof e?e:void 0,o=u(r)?0:b(r,n.__wbindgen_malloc,n.__wbindgen_realloc),i=d;p()[t/4+1]=i,p()[t/4+0]=o},_.wbg.__wbindgen_is_string=function(n){return"string"==typeof c(n)},_.wbg.__wbg_genericcontract_new=function(n){return a(N.__wrap(n))},_.wbg.__wbg_send_3a39cf3a085c863d=function(n,t,_,e){c(n).send(r(t,_),D.__wrap(e))},_.wbg.__wbindgen_is_object=function(n){const t=c(n);return"object"==typeof t&&null!==t},_.wbg.__wbindgen_number_get=function(n,t){const _=c(t);var e="number"==typeof _?_:void 0;h()[n/8+1]=u(e)?0:e,p()[n/4+0]=!u(e)},_.wbg.__wbg_isLocal_bff575c915a57596=function(n){return c(n).isLocal()},_.wbg.__wbindgen_boolean_get=function(n){const t=c(n);return"boolean"==typeof t?t?1:0:2},_.wbg.__wbindgen_is_null=function(n){return null===c(n)},_.wbg.__wbindgen_is_undefined=function(n){return void 0===c(n)},_.wbg.__wbindgen_cb_drop=function(n){const t=l(n).original;if(1==t.cnt--)return t.a=0,!0;return!1},_.wbg.__wbg_get_f45dff51f52d7222=function(n,t){return a(c(n)[t>>>0])},_.wbg.__wbg_length_7b60f47bde714631=function(n){return c(n).length},_.wbg.__wbg_new_16f24b0728c5e67b=function(){return a(new Array)},_.wbg.__wbg_get_8bbb82393651dd9c=function(){return P(function(n,t){return a(Reflect.get(c(n),c(t)))},arguments)},_.wbg.__wbg_new_d3138911a89329b0=function(){return a(new Object)},_.wbg.__wbg_isArray_8480ed76e5369634=function(n){return Array.isArray(c(n))},_.wbg.__wbg_push_a72df856079e6930=function(n,t){return c(n).push(c(t))},_.wbg.__wbg_new_55259b13834a484c=function(n,t){return a(new Error(r(n,t)))},_.wbg.__wbg_call_94697a95cb7e239c=function(){return P(function(n,t,_){return a(c(n).call(c(t),c(_)))},arguments)},_.wbg.__wbg_now_e6c39c10a5e8aec7=function(){return Date.now()},_.wbg.__wbg_keys_2d148611a251964d=function(n){return a(Object.keys(c(n)))},_.wbg.__wbg_new_4beacc9c71572250=function(n,t){try{var _={a:n,b:t};return a(new Promise((n,t)=>{const e=_.a;_.a=0;try{return H(e,_.b,n,t)}finally{_.a=e}}))}finally{_.a=_.b=0}},_.wbg.__wbg_resolve_4f8f547f26b30b27=function(n){return a(Promise.resolve(c(n)))},_.wbg.__wbg_then_a6860c82b90816ca=function(n,t){return a(c(n).then(c(t)))},_.wbg.__wbg_set_c42875065132a932=function(){return P(function(n,t,_){return Reflect.set(c(n),c(t),c(_))},arguments)},_.wbg.__wbindgen_debug_string=function(t,_){var e=b(m(c(_)),n.__wbindgen_malloc,n.__wbindgen_realloc),r=d;p()[t/4+1]=r,p()[t/4+0]=e},_.wbg.__wbindgen_throw=function(n,t){throw new Error(r(n,t))},_.wbg.__wbindgen_closure_wrapper1531=function(n,t,_){return a(v(n,t,506,k))},("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:e,module:o}=await Q(await t,_);return n=e.exports,J.__wbindgen_wasm_module=o,n}exports.GqlTransport=K;var z=J;exports.default=z;
},{}],"SQZr":[function(require,module,exports) {
module.exports=o,o.default=o,o.stable=a,o.stableStringify=a;var e="[...]",r="[Circular]",t=[],i=[];function n(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function o(e,r,o,f){var l;void 0===f&&(f=n()),u(e,"",0,[],void 0,0,f);try{l=0===i.length?JSON.stringify(e,r,o):JSON.stringify(e,s(r),o)}catch(c){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==t.length;){var a=t.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return l}function f(e,r,n,o){var f=Object.getOwnPropertyDescriptor(o,n);void 0!==f.get?f.configurable?(Object.defineProperty(o,n,{value:e}),t.push([o,n,r,f])):i.push([r,n,e]):(o[n]=e,t.push([o,n,r]))}function u(t,i,n,o,l,a,c){var s;if(a+=1,"object"==typeof t&&null!==t){for(s=0;s<o.length;s++)if(o[s]===t)return void f(r,t,i,l);if(void 0!==c.depthLimit&&a>c.depthLimit)return void f(e,t,i,l);if(void 0!==c.edgesLimit&&n+1>c.edgesLimit)return void f(e,t,i,l);if(o.push(t),Array.isArray(t))for(s=0;s<t.length;s++)u(t[s],s,s,o,t,a,c);else{var d=Object.keys(t);for(s=0;s<d.length;s++){var v=d[s];u(t[v],v,s,o,t,a,c)}}o.pop()}}function l(e,r){return e<r?-1:e>r?1:0}function a(e,r,o,f){void 0===f&&(f=n());var u,l=c(e,"",0,[],void 0,0,f)||e;try{u=0===i.length?JSON.stringify(l,r,o):JSON.stringify(l,s(r),o)}catch(d){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==t.length;){var a=t.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return u}function c(i,n,o,u,a,s,d){var v;if(s+=1,"object"==typeof i&&null!==i){for(v=0;v<u.length;v++)if(u[v]===i)return void f(r,i,n,a);try{if("function"==typeof i.toJSON)return}catch(y){return}if(void 0!==d.depthLimit&&s>d.depthLimit)return void f(e,i,n,a);if(void 0!==d.edgesLimit&&o+1>d.edgesLimit)return void f(e,i,n,a);if(u.push(i),Array.isArray(i))for(v=0;v<i.length;v++)c(i[v],v,v,u,i,s,d);else{var p={},g=Object.keys(i).sort(l);for(v=0;v<g.length;v++){var h=g[v];c(i[h],h,v,u,i,s,d),p[h]=i[h]}if(void 0===a)return p;t.push([a,n,i]),a[n]=p}u.pop()}}function s(e){return e=void 0!==e?e:function(e,r){return r},function(r,t){if(i.length>0)for(var n=0;n<i.length;n++){var o=i[n];if(o[1]===r&&o[0]===t){t=o[2],i.splice(n,1);break}}return e.call(this,r,t)}}
},{}],"FRpO":[function(require,module,exports) {
"use strict";var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function r(e){console&&console.warn&&console.warn(e)}e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}module.exports=o,module.exports.once=m,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function f(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var o,s,c;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),c=s[t]),void 0===c)c=s[t]=n,++e._eventsCount;else if("function"==typeof c?c=s[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),(o=f(e))>0&&c.length>o&&!c.warned){c.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=e,v.type=t,v.count=c.length,r(v)}return e}function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=v.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?d(i):h(i,i.length)}function a(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function h(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function d(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function m(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&L(e,i,{once:!0})})}function L(e,t,n){"function"==typeof e.on&&g(e,"error",t,n)}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)})}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return f(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var f=o[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var c=f.length,v=h(f,c);for(r=0;r<c;++r)n(v[r],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return u(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():y(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):a.call(e,t)},o.prototype.listenerCount=a,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};
},{}],"CjVZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertVersionToInt32=exports.SafeEventEmitter=exports.getUniqueId=void 0;const e=require("events"),t=4294967295;let r=Math.floor(Math.random()*t);function o(){return r=(r+1)%t}function n(e,t,r){try{Reflect.apply(e,t,r)}catch(o){setTimeout(()=>{throw o})}}function i(e){const t=e.length,r=new Array(t);for(let o=0;o<t;o+=1)r[o]=e[o];return r}exports.getUniqueId=o;class s extends e.EventEmitter{emit(e,...t){let r="error"===e;const o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;const r=new Error(`Unhandled error.${e?` (${e.message})`:""}`);throw r.context=e,r}const s=o[e];if(void 0===s)return!1;if("function"==typeof s)n(s,this,t);else{const e=s.length,r=i(s);for(let o=0;o<e;o+=1)n(r[o],this,t)}return!0}}exports.SafeEventEmitter=s;const l=e=>{let t=e.split(".");if(3!==t.length)throw new Error("Received invalid version string");t.forEach(e=>{if(~~e>999)throw new Error(`Version string invalid, ${e} is too large`)});let r=1e6,o=0;for(let n=0;n<3;n++)o+=~~t[n]*r,r/=1e3;return o};exports.convertVersionToInt32=l;
},{"events":"FRpO"}],"Fbol":[function(require,module,exports) {
"use strict";function t(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}function e(e){const n=document.createTextNode("");let o,i,r=0,u=0;return new e(function(){let t;if(o)i&&(o=i.slice(u).concat(o));else{if(!i)return;o=i}if(i=o,o=null,u=0,"function"==typeof i)return t=i,i=null,void t();for(n.data=r=++r%2;u<i.length;)t=i[u],++u===i.length&&(i=null),t()}).observe(n,{characterData:!0}),function(e){t(e),o?"function"==typeof o?o=[o,e]:o.push(e):(o=e,n.data=r=++r%2)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Mutex=exports.Semaphore=void 0;const n=function(){if("function"==typeof queueMicrotask)return function(e){queueMicrotask(t(e))};if("object"==typeof document&&document){if("function"==typeof MutationObserver)return e(MutationObserver);if("function"==typeof window.WebKitMutationObserver)return e(window.WebKitMutationObserver)}if("function"==typeof setImmediate)return function(e){setImmediate(t(e))};if("function"==typeof setTimeout||"object"==typeof setTimeout)return function(e){setTimeout(t(e),0)};throw new Error("No `nextTick` implementation found")}();class o{constructor(t){this.tasks=[],this.count=t}sched(){if(this.count>0&&this.tasks.length>0){this.count--;let t=this.tasks.shift();if(void 0===t)throw"Unexpected undefined value in tasks list";t()}}acquire(){return new Promise((t,e)=>{this.tasks.push(()=>{let e=!1;t(()=>{e||(e=!0,this.count++,this.sched())})}),n(this.sched.bind(this))})}use(t){return this.acquire().then(e=>t().then(t=>(e(),t)).catch(t=>{throw e(),t}))}}exports.Semaphore=o;class i extends o{constructor(){super(1)}}exports.Mutex=i;
},{}],"P8Ws":[function(require,module,exports) {
"use strict";var t=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),e=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var o={};if(null!=n)for(var i in n)"default"!==i&&Object.prototype.hasOwnProperty.call(n,i)&&t(o,n,i);return e(o,n),o};Object.defineProperty(exports,"__esModule",{value:!0}),exports.GqlSocket=void 0;const o=n(require("nekoton-wasm"));class i{async connect(t,e){return new o.GqlTransport(t,new class{constructor(t){this.nextLatencyDetectionTime=0,this.params=t,this.endpoints=t.endpoints.map(i.expandAddress),1==this.endpoints.length&&(this.currentEndpoint=this.endpoints[0],this.nextLatencyDetectionTime=Number.MAX_VALUE)}isLocal(){return this.params.local}send(t,e){(async()=>{const n=Date.now();try{let i;null!=this.currentEndpoint&&n<this.nextLatencyDetectionTime?i=this.currentEndpoint:null!=this.resolutionPromise?(i=await this.resolutionPromise,delete this.resolutionPromise):(delete this.currentEndpoint,this.resolutionPromise=this._selectQueryingEndpoint().then(t=>(this.currentEndpoint=t,this.nextLatencyDetectionTime=Date.now()+this.params.latencyDetectionInterval,t)),i=await this.resolutionPromise,delete this.resolutionPromise);const r=await fetch(i,{method:"post",headers:{"Content-Type":"application/json"},body:t}).then(t=>t.text());e.onReceive(r)}catch(o){e.onError(o)}})()}async _selectQueryingEndpoint(){const t=this.params.maxLatency||6e4;let e=this.endpoints.length;for(let o=0;o<5;++o){let r;const s=new Promise((t,e)=>{r={resolve:e=>t(e),reject:()=>e(void 0)}});let a,c=0;for(const n of this.endpoints)i.checkLatency(n).then(o=>{if(++c,void 0!==o&&o<=t)return r.resolve(n);(void 0===a||void 0===a.latency||void 0!==o&&o<a.latency)&&(a={endpoint:n,latency:o}),c>=e&&(void 0!==(null==a?void 0:a.latency)?r.resolve(a.endpoint):r.reject())});try{return await s}catch(n){let t;const e=new Promise(e=>{t=(()=>e())});setTimeout(()=>t(),Math.min(100*o,5e3)),await e}}throw new Error("Not available endpoint found")}}(e))}static async checkLatency(t){let e=await fetch(`${t}?query=%7Binfo%7Bversion%20time%20latency%7D%7D`,{method:"get"}).then(t=>t.json()).catch(t=>{console.error(t)});if("object"!=typeof e)return;let n=e.data;if("object"!=typeof n)return;let o=n.info;if("object"!=typeof o)return;let i=o.latency;return"number"==typeof i?i:void 0}}exports.GqlSocket=i,i.expandAddress=(t=>{const e=t.lastIndexOf("/");return(t=e<0?t:t.substring(0,e)).startsWith("http://")||t.startsWith("https://")?`${t}/graphql`:["localhost","127.0.0.1"].indexOf(t)>=0?`http://${t}/graphql`:`https://${t}/graphql`});
},{"nekoton-wasm":"YH9q"}],"T90g":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionController=exports.createConnectionController=exports.NETWORK_PRESETS=exports.DEFAULT_NETWORK_GROUP=void 0;const t=require("@broxus/await-semaphore"),e=require("./gql");async function r(t,e,r=!1){let a;if("string"==typeof e){const t=exports.NETWORK_PRESETS[e];if(null==t)throw new Error(`Target preset id not found: ${e}`);a=t}else a=e;for(;;)try{const e=new n(t);return await e.startSwitchingNetwork(a).then(t=>t.switch()),console.debug(`Successfully connected to ${a.group}`),e}catch(o){if(!r)throw o;console.error("Connection failed:",o),await new Promise(t=>{setTimeout(()=>t(),5e3)}),console.log("Restarting connection process")}}exports.DEFAULT_NETWORK_GROUP="mainnet",exports.NETWORK_PRESETS={mainnet:{group:"mainnet",type:"graphql",data:{endpoints:["eri01.main.everos.dev","gra01.main.everos.dev","gra02.main.everos.dev","lim01.main.everos.dev","rbx01.main.everos.dev"],latencyDetectionInterval:6e4,local:!1}},testnet:{group:"testnet",type:"graphql",data:{endpoints:["eri01.net.everos.dev","rbx01.net.everos.dev","gra01.net.everos.dev"],latencyDetectionInterval:6e4,local:!1}},fld:{group:"fld",type:"graphql",data:{endpoints:["gql.custler.net"],latencyDetectionInterval:6e4,local:!1}},local:{group:"localnet",type:"graphql",data:{endpoints:["127.0.0.1"],latencyDetectionInterval:6e4,local:!0}}},exports.createConnectionController=r;class n{constructor(e){this._networkMutex=new t.Mutex,this._acquiredTransportCounter=0,this._clock=e}async acquire(){return a(this._initializedTransport),await this._acquireTransport(),{transport:this._initializedTransport,release:()=>this._releaseTransport()}}async use(t){return a(this._initializedTransport),await this._acquireTransport(),t(this._initializedTransport).finally(()=>{this._releaseTransport()})}async startSwitchingNetwork(t){var e;return null===(e=this._cancelTestTransport)||void 0===e||e.call(this),new class{constructor(t,e,r){this._controller=t,this._release=e,this._params=r}async switch(){await this._controller._connect(this._params).finally(()=>this._release())}}(this,await this._networkMutex.acquire(),t)}get currentConnectionGroup(){var t;return null===(t=this._initializedTransport)||void 0===t?void 0:t.group}async _connect(t){let r;this._initializedTransport&&this._initializedTransport.data.transport.free(),this._initializedTransport=void 0,function(t){t[t.DONE=0]="DONE",t[t.CANCELLED=1]="CANCELLED"}(r||(r={}));const n=async({data:{transport:t}})=>new Promise((e,n)=>{this._cancelTestTransport=(()=>e(r.CANCELLED)),t.getFullContractState("-1:0000000000000000000000000000000000000000000000000000000000000000").then(()=>e(r.DONE)).catch(t=>n(t)),setTimeout(()=>n(new Error("Connection timeout")),1e4)}).finally(()=>this._cancelTestTransport=void 0);try{const{shouldTest:o,transportData:i}=await(async()=>{const r=new e.GqlSocket,n=await r.connect(this._clock,t.data);return{shouldTest:!t.data.local,transport:n,transportData:{type:"graphql",data:{socket:r,transport:n}}}})();if(o&&await n(i)==r.CANCELLED)return void i.data.transport.free();this._initializedTransport=i}catch(a){throw new Error(`Failed to create connection: ${a.toString()}`)}}async _acquireTransport(){console.debug("_acquireTransport"),this._acquiredTransportCounter>0?(console.debug("_acquireTransport -> increase"),this._acquiredTransportCounter+=1):(this._acquiredTransportCounter=1,null!=this._release?console.warn("mutex is already acquired"):(console.debug("_acquireTransport -> await"),this._release=await this._networkMutex.acquire(),console.debug("_acquireTransport -> create")))}_releaseTransport(){var t;console.debug("_releaseTransport"),this._acquiredTransportCounter-=1,this._acquiredTransportCounter<=0&&(console.debug("_releaseTransport -> release"),null===(t=this._release)||void 0===t||t.call(this),this._release=void 0)}}function a(t){if(null==t)throw new Error("Connection is not initialized")}exports.ConnectionController=n;
},{"@broxus/await-semaphore":"Fbol","./gql":"P8Ws"}],"S2yf":[function(require,module,exports) {
"use strict";var t=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),e=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var i={};if(null!=r)for(var o in r)"default"!==o&&Object.prototype.hasOwnProperty.call(r,o)&&t(i,r,o);return e(i,r),i};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContractSubscription=void 0;const i=require("@broxus/await-semaphore"),o=r(require("nekoton-wasm"));class s{constructor(t,e,r,o){this._contractMutex=new i.Mutex,this._pollingInterval=c,this._isRunning=!1,this._transport=t,this._address=r,this._contract=o,this._releaseTransport=e,this._currentPollingMethod=o.pollingMethod}static async subscribe(t,e,r){const{transport:{data:{transport:i}},release:o}=await t.acquire();try{const t=await i.subscribeToGenericContract(e,r);if(null==t)throw new Error(`Failed to subscribe to contract: ${e}`);return new s(i,o,e,t)}catch(n){throw o(),n}}setPollingInterval(t){this._pollingInterval=t}async start(){if(null==this._releaseTransport)throw new Error("Contract subscription must not be started after being closed");this._loopPromise&&(console.debug("ContractSubscription -> awaiting loop promise"),await this._loopPromise),console.debug("ContractSubscription -> loop started"),this._loopPromise=new Promise(async t=>{const e=!(this._transport instanceof o.GqlTransport);this._isRunning=!0;let r=this._currentPollingMethod;for(;this._isRunning;){const t=r!=this._currentPollingMethod;if(r=this._currentPollingMethod,e||"manual"==this._currentPollingMethod){this._currentBlockId=void 0,console.debug("ContractSubscription -> manual -> waiting begins");const t="manual"==this._currentPollingMethod?this._pollingInterval:a;if(await new Promise(e=>{const r=window.setTimeout(()=>{this._refreshTimer=void 0,e()},t);this._refreshTimer=[r,e]}),console.debug("ContractSubscription -> manual -> waiting ends"),!this._isRunning)break;console.debug("ContractSubscription -> manual -> refreshing begins");try{this._currentPollingMethod=await this._contractMutex.use(async()=>(await this._contract.refresh(),this._contract.pollingMethod))}catch(i){console.error(`Error during account refresh (${this._address})`,i)}console.debug("ContractSubscription -> manual -> refreshing ends")}else{const e=this._transport;let r;if(console.debug("ContractSubscription -> reliable start"),t&&null!=this._suggestedBlockId&&(this._currentBlockId=this._suggestedBlockId),this._suggestedBlockId=void 0,null==this._currentBlockId){console.warn("Starting reliable connection with unknown block");try{const t=await e.getLatestBlock(this._address);this._currentBlockId=t.id,r=this._currentBlockId}catch(i){console.error(`Failed to get latest block for ${this._address}`,i);continue}}else try{r=await e.waitForNextBlock(this._currentBlockId,this._address,n)}catch(i){console.error(`Failed to wait for next block for ${this._address}`);continue}try{this._currentPollingMethod=await this._contractMutex.use(async()=>(await this._contract.handleBlock(r),this._contract.pollingMethod)),this._currentBlockId=r}catch(i){console.error(`Failed to handle block for ${this._address}`,i)}}}console.debug("ContractSubscription -> loop finished"),t()})}skipRefreshTimer(){var t,e;window.clearTimeout(null===(t=this._refreshTimer)||void 0===t?void 0:t[0]),null===(e=this._refreshTimer)||void 0===e||e[1](),this._refreshTimer=void 0}async pause(){this._isRunning&&(this._isRunning=!1,this.skipRefreshTimer(),await this._loopPromise,this._loopPromise=void 0,this._currentPollingMethod=await this._contractMutex.use(async()=>this._contract.pollingMethod),this._currentBlockId=void 0,this._suggestedBlockId=void 0)}async stop(){var t;await this.pause(),this._contract.free(),null===(t=this._releaseTransport)||void 0===t||t.call(this),this._releaseTransport=void 0}async prepareReliablePolling(){try{this._transport instanceof o.GqlTransport&&(this._suggestedBlockId=(await this._transport.getLatestBlock(this._address)).id)}catch(t){throw new Error(`Failed to prepare reliable polling: ${t.toString()}`)}}async use(t){const e=await this._contractMutex.acquire();return t(this._contract).then(t=>(e(),t)).catch(t=>{throw e(),t})}}exports.ContractSubscription=s;const n=60,a=2e3,c=6e4;
},{"@broxus/await-semaphore":"Fbol","nekoton-wasm":"YH9q"}],"bHxS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubscriptionController=void 0;const s=require("@broxus/await-semaphore"),t=require("./subscription"),e=1e4;class i{constructor(t,e){this._subscriptions=new Map,this._subscriptionsMutex=new s.Mutex,this._sendMessageRequests=new Map,this._subscriptionStates=new Map,this._connectionController=t,this._notify=e}async subscribeToContract(s,t){return this._subscriptionsMutex.use(async()=>{let e=!0;const i=this._subscriptionStates.get(s)||n();if(Object.keys(i).map(s=>{if("state"!==s&&"transactions"!==s)throw new Error(`Unknown subscription topic: ${s}`);const n=t[s];if("boolean"!=typeof n)throw new Error(`Unknown subscription topic value: ${n}`);i[s]=n,e&&(e=!i[s])}),e)return this._subscriptionStates.delete(s),await this._tryUnsubscribe(s),{...i};let o=this._subscriptions.get(s);return null==o&&(o=await this._createSubscription(s)),this._subscriptionStates.set(s,i),o&&await o.start(),{...i}})}async unsubscribeFromContract(s){await this.subscribeToContract(s,{state:!1,transactions:!1})}async unsubscribeFromAllContracts(){const s=Array.from(this._subscriptions.keys());for(const t of s)await this.unsubscribeFromContract(t)}get subscriptionStates(){return[...this._subscriptionStates].reduce((s,[t,e])=>(s[t]=e,s),{})}async _createSubscription(s){const i=new class{constructor(s,t){this._enabled=!1,this._address=s,this._controller=t}enabledNotifications(){this._enabled=!0}onMessageExpired(s){this._enabled&&this._controller._rejectMessageRequest(this._address,s.bodyHash,new Error("Message expired")).catch(console.error)}onMessageSent(s,t){this._enabled&&this._controller._resolveMessageRequest(this._address,s.bodyHash,t).catch(console.error)}onStateChanged(s){this._enabled&&this._controller._notifyStateChanged(this._address,s)}onTransactionsFound(s,t){this._enabled&&this._controller._notifyTransactionsFound(this._address,s,t)}}(s,this),n=await t.ContractSubscription.subscribe(this._connectionController,s,i);return n.setPollingInterval(e),i.enabledNotifications(),this._subscriptions.set(s,n),n}async _tryUnsubscribe(s){const t=this._subscriptionStates.get(s),e=this._sendMessageRequests.get(s);if(null==t&&0==((null==e?void 0:e.size)||0)){const t=this._subscriptions.get(s);this._subscriptions.delete(s),await(null==t?void 0:t.stop())}}async _rejectMessageRequest(s,t,e){this._deleteMessageRequestAndGetCallback(s,t).reject(e),await this._subscriptionsMutex.use(async()=>this._tryUnsubscribe(s))}async _resolveMessageRequest(s,t,e){this._deleteMessageRequestAndGetCallback(s,t).resolve(e),await this._subscriptionsMutex.use(async()=>this._tryUnsubscribe(s))}_notifyStateChanged(s,t){const e=this._subscriptionStates.get(s);(null==e?void 0:e.state)&&this._notify("contractStateChanged",{address:s,state:t})}_notifyTransactionsFound(s,t,e){const i=this._subscriptionStates.get(s);(null==i?void 0:i.transactions)&&this._notify("transactionsFound",{address:s,transactions:t,info:e})}_deleteMessageRequestAndGetCallback(s,t){var e;const i=null===(e=this._sendMessageRequests.get(s))||void 0===e?void 0:e.get(t);if(!i)throw new Error(`SendMessage request with id '${t}' not found`);return this._deleteMessageRequest(s,t),i}_deleteMessageRequest(s,t){const e=this._sendMessageRequests.get(s);e&&(e.delete(t),0==e.size&&this._sendMessageRequests.delete(s))}}exports.SubscriptionController=i;const n=()=>({state:!1,transactions:!1});
},{"@broxus/await-semaphore":"Fbol","./subscription":"S2yf"}],"oFYt":[function(require,module,exports) {
"use strict";var t=this&&this.__createBinding||(Object.create?function(t,r,n,e){void 0===e&&(e=n),Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[n]}})}:function(t,r,n,e){void 0===e&&(e=n),t[e]=r[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:!0,value:r})}:function(t,r){t.default=r}),n=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var o in n)"default"!==o&&Object.prototype.hasOwnProperty.call(n,o)&&t(e,n,o);return r(e,n),e},e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.EverscaleStandaloneClient=exports.SUPPORTED_PERMISSIONS=exports.VERSION=exports.DEFAULT_CLIENT_PROPERTIES=exports.NETWORK_PRESETS=void 0;const o=n(require("nekoton-wasm")),s=o,a=e(require("fast-safe-stringify")),c=require("./utils"),i=require("./connectionController"),u=require("./subscriptionController");var l=require("./connectionController");Object.defineProperty(exports,"NETWORK_PRESETS",{enumerable:!0,get:function(){return l.NETWORK_PRESETS}});let p,d=!1,m=new Promise((t,r)=>{p={resolve:t,reject:r}});function h(){return d||(d=!0,(0,o.default)().then(p.resolve).catch(p.reject)),m}exports.DEFAULT_CLIENT_PROPERTIES={connection:i.DEFAULT_NETWORK_GROUP},exports.VERSION="0.2.25",exports.SUPPORTED_PERMISSIONS=["basic"];class b extends c.SafeEventEmitter{constructor(t){super(),this._handlers={requestPermissions:y,disconnect:f,subscribe:w,unsubscribe:g,unsubscribeAll:S,getProviderState:v,getFullContractState:C,getAccountsByCodeHash:E,getTransactions:T,getTransaction:P,runLocal:_,getExpectedAddress:I,getBocHash:O,packIntoCell:x,unpackFromCell:R,extractPublicKey:A,codeToTvc:k,splitTvc:j,encodeInternalInput:N,decodeInput:$,decodeEvent:F,decodeOutput:K,decodeTransaction:D,decodeTransactionEvents:q,verifySignature:H},this._context=t}static async create(t){await h();let r={};const n=(t,n)=>{var e,o;null===(o=null===(e=r.client)||void 0===e?void 0:e.deref())||void 0===o||o.emit(t,n)},e=new s.ClockWithOffset,o=await(0,i.createConnectionController)(e,t.connection),a=new u.SubscriptionController(o,n),c=new b({clock:e,permissions:{},connectionController:o,subscriptionController:a,notify:n});return r.client=new WeakRef(c),c}request(t){const r=this._handlers[t.method];if(null==r)throw nt(t,`Method '${t.method}' is not supported by standalone provider`);return r(this._context,t)}}exports.EverscaleStandaloneClient=b;const y=async(t,r)=>{M(r);const{permissions:n}=r.params;J(r,r.params,"permissions");const e={...t.permissions};for(const o of n){if("basic"!==o&&"tonClient"!==o)throw nt(r,`Permission '${o}' is not supported by standalone provider`);e.basic=!0}return t.permissions=e,t.notify("permissionsChanged",{permissions:{...e}}),{...e}},f=async(t,r)=>{t.permissions={},await t.subscriptionController.unsubscribeFromAllContracts(),t.notify("permissionsChanged",{permissions:{}})},w=async(t,r)=>{M(r);const{address:n,subscriptions:e}=r.params;if(B(r,r.params,"address"),U(r,r.params,"subscriptions"),!s.checkAddress(n))throw nt(r,"Invalid address");try{return await t.subscriptionController.subscribeToContract(n,e)}catch(o){throw nt(r,o.toString())}},g=async(t,r)=>{M(r);const{address:n}=r.params;if(B(r,r.params,"address"),!s.checkAddress(n))throw nt(r,"Invalid address");await t.subscriptionController.unsubscribeFromContract(n)},S=async(t,r)=>{await t.subscriptionController.unsubscribeFromAllContracts()},v=async(t,r)=>{const n=t.connectionController.currentConnectionGroup;if(null==n)throw nt(r,"Connection controller was not initialized");const e=exports.VERSION;return{version:e,numericVersion:(0,c.convertVersionToInt32)(e),selectedConnection:n,supportedPermissions:[...exports.SUPPORTED_PERMISSIONS],permissions:{...t.permissions},subscriptions:t.subscriptionController.subscriptionStates}},C=async(t,r)=>{M(r);const{address:n}=r.params;B(r,r.params,"address");const{connectionController:e}=t;try{return e.use(async({data:{transport:t}})=>({state:await t.getFullContractState(n)}))}catch(o){throw nt(r,o.toString())}},E=async(t,r)=>{M(r);const{codeHash:n,limit:e,continuation:o}=r.params;B(r,r.params,"codeHash"),G(r,r.params,"limit"),z(r,r.params,"continuation");const{connectionController:s}=t;try{return s.use(({data:{transport:t}})=>t.getAccountsByCodeHash(n,e||50,o))}catch(a){throw nt(r,a.toString())}},T=async(t,r)=>{M(r);const{address:n,continuation:e,limit:o}=r.params;B(r,r.params,"address"),Q(r,r.params,"continuation",X),G(r,r.params,"limit");const{connectionController:s}=t;try{return s.use(({data:{transport:t}})=>t.getTransactions(n,e,o||50))}catch(a){throw nt(r,a.toString())}},P=async(t,r)=>{M(r);const{hash:n}=r.params;B(r,r.params,"hash");const{connectionController:e}=t;try{return{transaction:await e.use(({data:{transport:t}})=>t.getTransaction(n))}}catch(o){throw nt(r,o.toString())}},_=async(t,r)=>{M(r);const{address:n,cachedState:e,responsible:o,functionCall:a}=r.params;B(r,r.params,"address"),Q(r,r.params,"cachedState",Z),W(r,r.params,"responsible"),tt(r,r.params,"functionCall");const{clock:c,connectionController:i}=t;let u=e;if(null==u&&(u=await i.use(async({data:{transport:t}})=>t.getFullContractState(n))),null==u)throw nt(r,"Account not found");if(!u.isDeployed||null==u.lastTransactionId)throw nt(r,"Account is not deployed");try{const{output:t,code:n}=s.runLocal(c,u.boc,a.abi,a.method,a.params,o||!1);return{output:t,code:n}}catch(l){throw nt(r,l.toString())}},I=async(t,r)=>{M(r);const{tvc:n,abi:e,workchain:o,publicKey:a,initParams:c}=r.params;B(r,r.params,"tvc"),B(r,r.params,"abi"),G(r,r.params,"workchain"),z(r,r.params,"publicKey");try{return{address:s.getExpectedAddress(n,e,o||0,a,c)}}catch(i){throw nt(r,i.toString())}},O=async(t,r)=>{M(r);const{boc:n}=r.params;B(r,r.params,"boc");try{return{hash:s.getBocHash(n)}}catch(e){throw nt(r,e.toString())}},x=async(t,r)=>{M(r);const{structure:n,data:e}=r.params;J(r,r.params,"structure");try{return{boc:s.packIntoCell(n,e)}}catch(o){throw nt(r,o.toString())}},R=async(t,r)=>{M(r);const{structure:n,boc:e,allowPartial:o}=r.params;J(r,r.params,"structure"),B(r,r.params,"boc"),V(r,r.params,"allowPartial");try{return{data:s.unpackFromCell(n,e,o)}}catch(a){throw nt(r,a.toString())}},A=async(t,r)=>{M(r);const{boc:n}=r.params;B(r,r.params,"boc");try{return{publicKey:s.extractPublicKey(n)}}catch(e){throw nt(r,e.toString())}},k=async(t,r)=>{M(r);const{code:n}=r.params;B(r,r.params,"code");try{return{tvc:s.codeToTvc(n)}}catch(e){throw nt(r,e.toString())}},j=async(t,r)=>{M(r);const{tvc:n}=r.params;B(r,r.params,"tvc");try{return s.splitTvc(n)}catch(e){throw nt(r,e.toString())}},N=async(t,r)=>{M(r),tt(r,r,"params");const{abi:n,method:e,params:o}=r.params;try{return{boc:s.encodeInternalInput(n,e,o)}}catch(a){throw nt(r,a.toString())}},$=async(t,r)=>{M(r);const{body:n,abi:e,method:o,internal:a}=r.params;B(r,r.params,"body"),B(r,r.params,"abi"),rt(r,r.params,"method"),V(r,r.params,"internal");try{return s.decodeInput(n,e,o,a)||null}catch(c){throw nt(r,c.toString())}},F=async(t,r)=>{M(r);const{body:n,abi:e,event:o}=r.params;B(r,r.params,"body"),B(r,r.params,"abi"),rt(r,r.params,"event");try{return s.decodeEvent(n,e,o)||null}catch(a){throw nt(r,a.toString())}},K=async(t,r)=>{M(r);const{body:n,abi:e,method:o}=r.params;B(r,r.params,"body"),B(r,r.params,"abi"),rt(r,r.params,"method");try{return s.decodeOutput(n,e,o)||null}catch(a){throw nt(r,a.toString())}},D=async(t,r)=>{M(r);const{transaction:n,abi:e,method:o}=r.params;B(r,r.params,"abi"),rt(r,r.params,"method");try{return s.decodeTransaction(n,e,o)||null}catch(a){throw nt(r,a.toString())}},q=async(t,r)=>{M(r);const{transaction:n,abi:e}=r.params;B(r,r.params,"abi");try{return{events:s.decodeTransactionEvents(n,e)}}catch(o){throw nt(r,o.toString())}},H=async(t,r)=>{M(r);const{publicKey:n,dataHash:e,signature:o}=r.params;B(r,r.params,"publicKey"),B(r,r.params,"dataHash"),B(r,r.params,"signature");try{return{isValid:s.verifySignature(n,e,o)}}catch(a){throw nt(r,a.toString())}};function M(t){if(null==t.params||"object"!=typeof t.params)throw nt(t,"required params object")}function L(t,r,n){if("object"!=typeof r[n])throw nt(t,`'${n}' must be an object`)}function U(t,r,n){const e=r[n];if(null!=e&&"object"!=typeof e)throw nt(t,`'${n}' must be an object if specified`)}function V(t,r,n){if("boolean"!=typeof r[n])throw nt(t,`'${n}' must be a boolean`)}function W(t,r,n){const e=r[n];if(null!=e&&"boolean"!=typeof e)throw nt(t,`'${n}' must be a boolean if specified`)}function B(t,r,n){const e=r[n];if("string"!=typeof e||0===e.length)throw nt(t,`'${n}' must be non-empty string`)}function z(t,r,n){const e=r[n];if(null!=e&&("string"!=typeof e||0===e.length))throw nt(t,`'${n}' must be a non-empty string if provided`)}function G(t,r,n){const e=r[n];if(null!=e&&"number"!=typeof e)throw nt(t,`'${n}' must be a number if provider`)}function J(t,r,n){const e=r[n];if(!Array.isArray(e))throw nt(t,`'${n}' must be an array`)}function Q(t,r,n,e){null!=r[n]&&e(t,r,n)}function X(t,r,n){L(t,r,n);const e=r[n];B(t,e,"lt"),B(t,e,"hash")}function Y(t,r,n){L(t,r,n);const e=r[n];V(t,e,"isExact"),B(t,e,"lt"),z(t,e,"hash")}function Z(t,r,n){L(t,r,n);const e=r[n];B(t,e,"balance"),Q(t,e,"lastTransactionId",Y),V(t,e,"isDeployed")}function tt(t,r,n){L(t,r,n);const e=r[n];B(t,e,"abi"),B(t,e,"method"),L(t,e,"params")}function rt(t,r,n){const e=r[n];if("string"!=typeof e&&!Array.isArray(e))throw nt(t,`'${n}' must be a method name or an array of possible names`)}const nt=(t,r,n)=>new et(2,`${t.method}: ${r}`,n);class et extends Error{constructor(t,r,n){if(!Number.isInteger(t))throw new Error('"code" must be an integer');if(!r||"string"!=typeof r)throw new Error('"message" must be a nonempty string');super(r),this.code=t,this.data=n}serialize(){const t={code:this.code,message:this.message};return void 0!==this.data&&(t.data=this.data),this.stack&&(t.stack=this.stack),t}toString(){return(0,a.default)(this.serialize(),ot,2)}}const ot=(t,r)=>{if("[Circular]"!==r)return r};
},{"nekoton-wasm":"YH9q","fast-safe-stringify":"SQZr","./utils":"CjVZ","./connectionController":"T90g","./subscriptionController":"bHxS"}],"H6gL":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(a,o){function i(e){try{s(r.next(e))}catch(n){o(n)}}function c(e){try{s(r.throw(e))}catch(n){o(n)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(i,c)}s((r=r.apply(e,n||[])).next())})},n=this&&this.__generator||function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(c){o=[6,c],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("everscale-inpage-provider"),r=require("everscale-standalone-client"),a={"ABI version":2,header:["time","expire"],functions:[{name:"getDePoolInfo",inputs:[],outputs:[{name:"poolClosed",type:"bool"},{name:"minStake",type:"uint64"},{name:"validatorAssurance",type:"uint64"},{name:"participantRewardFraction",type:"uint8"},{name:"validatorRewardFraction",type:"uint8"},{name:"balanceThreshold",type:"uint64"},{name:"validatorWallet",type:"address"},{name:"proxies",type:"address[]"},{name:"stakeFee",type:"uint64"},{name:"retOrReinvFee",type:"uint64"},{name:"proxyFee",type:"uint64"}]}],data:[],events:[]},o=new t.ProviderRpcClient({fallback:function(){return r.EverscaleStandaloneClient.create({connection:"mainnet"})}});function i(e,n){document.querySelectorAll("[data-behavior=".concat(e,"]")).forEach(n)}var c=function(e){return function(n){n.innerText=e}};function s(){return e(this,void 0,void 0,function(){var e,r,s,u,l;return n(this,function(n){switch(n.label){case 0:return[4,o.ensureInitialized()];case 1:return n.sent(),[4,o.requestPermissions({permissions:["basic"]})];case 2:return n.sent(),[4,o.getProviderState()];case 3:e=n.sent(),i("network",c("Selected connection: ".concat(e.selectedConnection))),r=new t.Address("0:bbcbf7eb4b6f1203ba2d4ff5375de30a5408a8130bf79f870efbcfd49ec164e9"),s=new o.Contract(a,r),n.label=4;case 4:return n.trys.push([4,6,,7]),[4,s.methods.getDePoolInfo({}).call()];case 5:return u=n.sent(),i("log",c(JSON.stringify(u,null,2))),[3,7];case 6:return(l=n.sent())instanceof t.TvmException&&i("log",c("TvmException code: ".concat(l.code))),[3,7];case 7:return[2]}})})}s().catch(console.error);
},{"everscale-inpage-provider":"RebX","everscale-standalone-client":"oFYt"}]},{},["H6gL"], null)